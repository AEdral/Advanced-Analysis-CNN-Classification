# Relazione del Progetto di Tesi

**Data**: 28/09/2024

Durante l'implementazione del metodo Grad-CAM all'interno del mio progetto di tesi, ho riscontrato un problema legato al preprocessing delle immagini. Inizialmente, per preprocessare le immagini, ho utilizzato il metodo fornito dalla libreria VGG16, ovvero tf.keras.applications.vgg16.preprocess_input. Tuttavia, questo metodo si è rivelato non adatto per il mio modello poiché il preprocessing corretto per il caso specifico richiedeva una semplice normalizzazione dell'input tramite img_array / 255.0.

## Problema Riscontrato

Con l'utilizzo di tf.keras.applications.vgg16.preprocess_input, ho notato che il metodo Grad-CAM produceva risultati anomali. Le heatmap risultavano completamente blu, segnalando un intervallo di valori minimi e massimi sempre pari a 0 (min = 0.0, max = 0.0). Questo indicava che non venivano evidenziate correttamente le regioni attive della rete. L'assenza di variazioni nei gradienti era dovuta a un preprocessing errato che alterava le caratteristiche originali dell'immagine, portando a una perdita di informazioni utili per il calcolo dei gradienti.

## Risoluzione del Bug

Ho risolto il problema sostituendo il preprocessing con la normale divisione del vettore immagine per 255.0 (img_array / 255.0), rendendo i dati compatibili con il mio modello. Una volta corretto il preprocessing, il metodo Grad-CAM ha iniziato a funzionare correttamente, generando heatmap adeguate e permettendomi di visualizzare chiaramente le attivazioni della rete neurale in risposta alle immagini di input.

### Utilizzo di Modelli Preaddestrati

Per evitare di perdere tempo nell'addestramento di una rete neurale convoluzionale complessa da zero, ho optato per utilizzare modelli preaddestrati disponibili online. In particolare, ho trovato due modelli adatti al contesto della classificazione delle immagini del COVID-19:

-   VGG16 – Un modello di rete neurale convoluzionale con 13 livelli    convoluzionali preaddestrato su immagini del COVID-19.
-   COVID-Net – Un modello specifico per la classificazione delle radiografie toraciche legate a infezioni polmonari, incluso il COVID-19.

Ho deciso di concentrarmi sulla VGG16, in quanto a livello di codice era più simile alla mia architettura. 

-   [VGG16](structure_vgg16.jpg)

Il modello VGG16 è stato applicato a un dataset di immagini COVID-19 ed è stato possibile eseguire con successo il metodo Grad-CAM intra-layer (cioè applicando Grad-CAM su diversi strati convoluzionali della rete), ottenendo risultati soddisfacenti.

- [Gradcam della VGG16](vgg16_gradcam.png)
- [Gradcam della VGG16](vgg16_gradcam2.png)


## Prossimi Passi: LIME e SHAP

Dopo aver risolto il problema con il metodo Grad-CAM, proseguirò l'analisi applicando gli strumenti di interpretabilità LIME e SHAP su due modelli:

Un modello convoluzionale a 4 layer da me creato, che ha dimostrato prestazioni inferiori rispetto ai modelli preaddestrati.
Il modello VGG16 preaddestrato, che ha mostrato buone capacità di classificazione sulle immagini COVID-19.
Questa fase mi permetterà di approfondire l'analisi del comportamento dei due modelli, confrontando la loro capacità di spiegare le predizioni e identificare le aree rilevanti delle immagini utilizzando metodi avanzati di interpretabilità.




