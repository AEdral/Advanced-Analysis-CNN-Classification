# Relazione del Progetto di Tesi

**Data**: 30/09/2024

Dopo aver importato e testato la rete VGG16 ho utilizzato il metodo LIME per l'analisi del risultato della classificazione.

## LIME
### Cos'è LIME?
LIME (Local Interpretable Model-agnostic Explanations) è una tecnica progettata per spiegare in modo semplice e interpretabile il comportamento di modelli di machine learning complessi, come le reti neurali profonde, su un singolo esempio (come un'immagine o un testo). Il principale obiettivo di LIME è quello di fornire spiegazioni locali per una specifica predizione piuttosto che per l'intero modello. Questo lo rende utile quando vogliamo capire perché un modello ha preso una certa decisione su un particolare input.

In parole semplici:

- LIME aiuta a capire quali parti di un'immagine o di un dato sono state considerate dal modello per fare una certa predizione.
- Funziona per qualsiasi tipo di modello, non importa quanto sia complesso (per questo è chiamato "model-agnostic").

### Superpixel
I superpixel sono regioni omogenee di un'immagine, raggruppate in base a somiglianze di colore o texture. In pratica, anziché analizzare l'immagine pixel per pixel (che potrebbe essere troppo dettagliato e non significativo), LIME suddivide l'immagine in blocchi più grandi e significativi (i superpixel), che contengono gruppi di pixel simili tra loro.

Esempio: Immagina una foto di un volto umano. Anziché analizzare ogni singolo pixel, un superpixel potrebbe coprire l'intera area di un occhio o del naso, raggruppando quei pixel perché simili in termini di colore e consistenza.

### Modello Interpretabile
Un modello interpretabile è un modello di machine learning che possiamo comprendere facilmente, come una regressione lineare o un albero di decisione. Questi modelli sono "trasparenti", nel senso che possiamo capire come ogni variabile influisce sulla predizione.

LIME crea un modello interpretabile locale attorno a una singola predizione del modello complesso. In pratica, cerca di approssimare il comportamento del modello complesso con un modello più semplice, ma solo per quella specifica immagine o esempio.

### Come funziona LIME in pratica?
1) Dividi l'immagine in superpixel: LIME suddivide l'immagine in blocchi di superpixel per rappresentare le aree significative.

2) Perturba l'immagine: Per capire quanto ogni superpixel è importante, LIME modifica casualmente l'immagine, rimuovendo o nascondendo alcuni superpixel e osservando come cambia la predizione del modello.

3) Costruisce un modello interpretabile locale: LIME utilizza le immagini modificate per costruire un modello semplice (ad esempio, una regressione lineare) che spiega come ogni superpixel contribuisce alla 
predizione fatta dal modello originale, solo per quell'immagine specifica.

4) Evidenzia le parti rilevanti: Alla fine, LIME ci mostra quali superpixel hanno contribuito di più alla predizione, evidenziando le parti dell'immagine che hanno influenzato maggiormente il risultato.

## Analisi LIME
1. Preprocessing delle immagini Per poter applicare LIME, ogni immagine è stata preprocessata. L'immagine è stata ridimensionata a (224, 224) per rispettare l'input richiesto dalla rete VGG16. Le immagini sono state normalizzate, come richiesto dal modello, e convertite in un formato che LIME potesse utilizzare.

2. Applicazione di LIME Il metodo LIME è stato applicato per comprendere l'importanza locale dei superpixel di un'immagine. L'approccio è consistito nei seguenti passi:

LIME ha suddiviso l'immagine in superpixel (regioni omogenee) e ha perturbato casualmente queste regioni.
Per ogni immagine perturbata, LIME ha chiesto al modello VGG16 di fare una predizione.
LIME ha costruito un modello interpretabile (ad esempio, una regressione lineare) per comprendere come i superpixel influenzano localmente la predizione del modello.

3. Visualizzazione dei risultati La visualizzazione dei risultati è stata effettuata tramite:

- Immagine con superpixel rilevanti: sono stati evidenziati solo i superpixel che hanno contribuito positivamente alla predizione finale, per evidenziare le regioni che influenzano la classe predetta.
- Superpixel con contributo negativo: sono stati visualizzati anche i superpixel con impatto negativo per una comprensione più completa dell'influenza locale.
-   [Superpixel Positivi e Negativi](lime_test.png)

Contributo di ciascun superpixel: LIME ha fornito anche il punteggio di rilevanza di ogni superpixel, visualizzando quelli più importanti.


## Risultati
1. Identificazione delle aree critiche LIME ha evidenziato i superpixel che hanno il maggiore impatto sulle predizioni della rete VGG16. Per esempio, nelle immagini di polmoni affetti da COVID-19, LIME ha mostrato che il modello concentra la sua attenzione principalmente sulle aree dei polmoni che presentano anomalie visibili nelle radiografie, come macchie o opacità polmonari.

2. Visualizzazione progressiva Sono state generate visualizzazioni progressive per le prime N regioni rilevanti, dove il modello ha rivelato la sua sensibilità alle parti più significative delle immagini. Con un numero crescente di superpixel, è stato possibile ottenere un quadro più dettagliato delle regioni considerate rilevanti per la classificazione.

3. Interpretazione della predizione LIME ha anche fornito un modello interpretabile locale che ha spiegato il contributo dei superpixel nel contesto di predizioni locali. Questo ha permesso di capire non solo quali regioni erano importanti, ma anche il loro contributo numerico alla decisione finale.





